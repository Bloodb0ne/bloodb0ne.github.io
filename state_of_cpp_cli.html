<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>State of CLI in the CPP World - Treebound Science / Maybe everything can be expressed as a tree structure</title>
    <meta property="og:title" content="State of CLI in the CPP World">
    <meta property="og:site_name" content="Treebound Science / Maybe everything can be expressed as a tree structure">
    <meta property="og:url" content="http://bloodb0ne.github.io">
    <meta property="og:description" content="Something doesnt really look right in the staticly typed language landscape">
    <meta property="og:type" content="article">
    <meta property="og:image" content="http://bloodb0ne.github.io/images/cli_state.png">

</head>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans&family=Roboto:wght@100;300;400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style/main.css">
<link rel="stylesheet" href="style/prism.css">
<script src="scripts/main.js"></script>

<script>
  

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3.0.0/es5/tex-chtml-full.js">
</script>

    <header>
        <a href='index.html' class='logo'>
            <svg width="48" height="48" version="1.1" viewBox="0 0 12.7 12.7" xmlns="http://www.w3.org/2000/svg">
     <defs>
      <marker id="TriangleOutM" overflow="visible" orient="auto">
       <path transform="scale(.4)" d="m5.77 0-8.65 5v-10l8.65 5z" fill-rule="evenodd" stroke="#000" fill="#fff" stroke-width="1pt"/>
      </marker>
      <marker id="TriangleOutM-6" overflow="visible" orient="auto">
       <path transform="scale(.4)" d="m5.77 0-8.65 5v-10z" fill-rule="evenodd" stroke="#000" fill="#fff" stroke-width="1pt"/>
      </marker>
     </defs>
     <g transform="translate(0,-284.3)">
      <g transform="matrix(1.1658,0,0,1.0998,-1.2421,-31.948)" aria-label="â¨">
       <path d="m6.7634 288.2q-0.19162-0.0808-0.41061-0.0808t-0.41061 0.0808q-0.18751 0.0794-0.34354 0.23542-0.15877 0.15739-0.23678 0.34627-0.078015 0.18888-0.078015 0.41198 0 0.21762 0.078015 0.4065t0.23678 0.34627q0.15603 0.15603 0.34354 0.23542 0.19162 0.0808 0.41061 0.0808t0.41061-0.0808q0.18751-0.0794 0.34354-0.23542 0.15877-0.15739 0.23678-0.34627 0.078015-0.18888 0.078015-0.4065 0-0.2231-0.078015-0.41198t-0.23678-0.34627q-0.15603-0.15603-0.34354-0.23542zm-0.9266-0.22583q0.24363-0.10813 0.51599-0.10813 0.27237 0 0.50641 0.0985t0.4284 0.29153q0.19435 0.19435 0.29153 0.42977 0.095808 0.23267 0.095808 0.50778 0 0.26963-0.095808 0.50504-0.097177 0.23268-0.29153 0.42703-0.19435 0.19299-0.4284 0.29153-0.23405 0.0985-0.50641 0.0985-0.27237 0-0.50641-0.0985t-0.4284-0.29153q-0.19435-0.19435-0.29153-0.42703-0.095808-0.23541-0.095808-0.50504 0-0.27511 0.095808-0.50778 0.097177-0.23542 0.29153-0.42977 0.17519-0.17519 0.41882-0.28195zm0.63096 0.20941v0.89375h0.89375v0.23268h-0.89375v0.89375h-0.22994v-0.89375h-0.89375v-0.23268h0.89375v-0.89375z" stroke-width=".095559"/>
      </g>
      <g stroke="#000">
       <path d="m5.1869 288.39-1.7355 3.4286" fill="none" marker-end="url(#TriangleOutM)" stroke="#000" stroke-width=".34496px"/>
       <g fill="#ffffed">
        <g stroke-linecap="round" stroke-linejoin="round">
         <ellipse cx="2.0582" cy="294.97" rx="1.8798" ry="1.8235" stroke-width=".1544"/>
         <path transform="matrix(.26458 0 0 .26458 0 284.3)" d="m38.438 34.09a8.9193 6.8047 0 0 0-8.9199 6.8047 8.9193 6.8047 0 0 0 8.9199 6.8047 8.9193 6.8047 0 0 0 8.9199-6.8047 8.9193 6.8047 0 0 0-8.9199-6.8047zm0 0.95312a5.9082 3.2066 0 0 1 5.9082 3.2051 5.9082 3.2066 0 0 1-5.9082 3.207 5.9082 3.2066 0 0 1-5.9082-3.207 5.9082 3.2066 0 0 1 5.9082-3.2051z" stroke-width=".58356"/>
        </g>
        <g stroke-width=".1544">
         <path d="m0.62189 294.31c-0.5132 0.43858-0.44395 0.76825-0.44395 0.76825"/>
         <path d="m1.1964 294.67c-0.89579 0.69627-0.75961 1.2111-0.75961 1.2111"/>
         <path d="m1.0873 295.29c-0.56049 0.498-0.46195 0.84985-0.46195 0.84985"/>
         <path d="m1.3298 295.62c-0.51639 0.43521-0.44955 0.76533-0.44955 0.76533"/>
        </g>
        <g stroke-width=".10504">
         <path d="m1.4212 296.03c-0.32157 0.33236-0.28655 0.58341-0.28655 0.58341"/>
         <path d="m8.2267 295.25c-0.29782 0.35151-0.24546 0.59985-0.24546 0.59985"/>
         <path d="m8.8718 295.89c-0.29782 0.35151-0.24546 0.59985-0.24546 0.59985"/>
         <path d="m8.397 295.5c-0.29782 0.35148-0.24546 0.59985-0.24546 0.59985"/>
         <path d="m8.1301 294.98c-0.29782 0.35148-0.24546 0.59985-0.24546 0.59985"/>
         <path d="m8.5923 295.69c-0.29782 0.3515-0.24546 0.59985-0.24546 0.59985"/>
        </g>
        <path d="m8.9301 294.34c0.86746-0.69546 1.6021-0.53205 2.4696-0.0251" stroke-linecap="round" stroke-width=".77201"/>
        <path d="m1.0259 294.35c-0.89229 0.70025-0.75352 1.2144-0.75352 1.2144" stroke-width=".1544"/>
       </g>
       <path d="m7.0705 288.39 1.7355 3.4286" fill="none" marker-end="url(#TriangleOutM-6)" stroke-width=".34496px"/>
      </g>
     </g>
    </svg>
    
            </a>
            <div>
                <a href="https://twitter.com/emilianbr">
                    <svg version="1.1" id="White" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                        viewBox="0 0 400 400" style="enable-background:new 0 0 400 400;" xml:space="preserve">
                    <path class="st0" d="M400,200c0,110.5-89.5,200-200,200S0,310.5,0,200S89.5,0,200,0S400,89.5,400,200z M163.4,305.5
                        c88.7,0,137.2-73.5,137.2-137.2c0-2.1,0-4.2-0.1-6.2c9.4-6.8,17.6-15.3,24.1-25c-8.6,3.8-17.9,6.4-27.7,7.6
                        c10-6,17.6-15.4,21.2-26.7c-9.3,5.5-19.6,9.5-30.6,11.7c-8.8-9.4-21.3-15.2-35.2-15.2c-26.6,0-48.2,21.6-48.2,48.2
                        c0,3.8,0.4,7.5,1.3,11c-40.1-2-75.6-21.2-99.4-50.4c-4.1,7.1-6.5,15.4-6.5,24.2c0,16.7,8.5,31.5,21.5,40.1c-7.9-0.2-15.3-2.4-21.8-6
                        c0,0.2,0,0.4,0,0.6c0,23.4,16.6,42.8,38.7,47.3c-4,1.1-8.3,1.7-12.7,1.7c-3.1,0-6.1-0.3-9.1-0.9c6.1,19.2,23.9,33.1,45,33.5
                        c-16.5,12.9-37.3,20.6-59.9,20.6c-3.9,0-7.7-0.2-11.5-0.7C110.8,297.5,136.2,305.5,163.4,305.5"/>
                    </svg>
                </a>
                <a href="https://github.com/bloodb0ne">
                    <svg version="1.1" viewBox="0 0 11.493 11.209" xmlns="http://www.w3.org/2000/svg">
                    <g transform="translate(-45.658 -38.151)">
                    <path d="m51.404 38.151c-3.1729 0-5.746 2.5728-5.746 5.7468 0 2.5386 1.6464 4.6926 3.9299 5.4529 0.28751 0.05256 0.39229-0.12488 0.39229-0.27728 0-0.13652-0.0049-0.49777-0.0078-0.97719-1.5984 0.34713-1.9357-0.77047-1.9357-0.77047-0.26141-0.66393-0.63818-0.84067-0.63818-0.84067-0.52176-0.3563 0.03951-0.34925 0.03951-0.34925 0.57679 0.04057 0.88018 0.59231 0.88018 0.59231 0.51259 0.87806 1.3451 0.62442 1.6725 0.47731 0.05221-0.37112 0.20073-0.62442 0.36477-0.768-1.276-0.14534-2.6176-0.63818-2.6176-2.8402 0-0.62759 0.22401-1.1402 0.59161-1.542-0.05927-0.14534-0.25647-0.72954 0.05644-1.5208 0 0 0.48225-0.15452 1.5801 0.58879 0.45826-0.12735 0.95003-0.19085 1.4386-0.19332 0.48824 0.0025 0.97966 0.06597 1.4386 0.19332 1.0971-0.7433 1.5787-0.58879 1.5787-0.58879 0.31362 0.79128 0.11642 1.3755 0.0575 1.5208 0.3683 0.40181 0.59055 0.9144 0.59055 1.542 0 2.2077-1.3437 2.6935-2.6236 2.8356 0.20602 0.17745 0.38982 0.52811 0.38982 1.0643 0 0.768-0.0071 1.3878-0.0071 1.5762 0 0.15381 0.10372 0.33267 0.39511 0.27658 2.2818-0.76165 3.9268-2.9139 3.9268-5.4522 0-3.1739-2.5732-5.7468-5.7471-5.7468" fill="#1b1817" fill-rule="evenodd"/>
                    </g>
                    </svg>
                </a>
                <a href="rss.xml">
    <svg version="1.1" viewBox="0 0 60 60" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path d="m41.164 42.268h5.104c0-14.633-11.904-26.545-26.535-26.545v5.09c11.814-1e-3 21.431 9.626 21.431 21.455zm-17.898 9e-3c1.957 0 3.538-1.572 3.538-3.521 0-1.938-1.581-3.528-3.538-3.528-1.949 0-3.533 1.59-3.533 3.528-1e-3 1.949 1.583 3.521 3.533 3.521zm8.877-7e-3h5.11c0-9.664-7.862-17.525-17.521-17.525v5.088c3.313 0 6.429 1.295 8.774 3.643 2.344 2.34 3.637 5.469 3.637 8.794zm-2.143 17.73c-16.568 0-30-13.432-30-30 0-16.569 13.432-30 30-30s30 13.431 30 30c0 16.568-13.432 30-30 30z" clip-rule="evenodd" fill="#010101" fill-rule="evenodd"/></svg>
                </a>
            </div>
    </header>    <main class="parent">
    <div class="sidebar box"></div>
    <div class="content box">
        <section id='title-section'>
            <h1>State of CLI in the CPP World</h1>
            <div class='datetime'><time datetime="2021-01-04T20:00:00.000Z">04 January 2021</time></div>
            <p>Something doesnt really look right in the staticly typed language landscape</p>
        </section>
    <p>After playing with some experimental code here and there comes a moment when you want to control it via some arguments, and most of the time we do that in a dynamic language but what happens in the world of C++.
Well we get our arguments conveniently split from our main entry point <code>main(int argc,char* argv[])</code> , from then on out we are on our own. Lets take a look a couple of example of Command line parsing libraries that help us manage those arguments and help us construct a nice control flow into our code.</p>
<h1 id="current-popular-solutions">Current Popular Solutions<a href="#current-popular-solutions">
				<svg width="32" height="32" version="1.1" viewBox="0 0 8.4667 8.4667" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(0 -288.53)" fill="none"  stroke-linecap="round" stroke-linejoin="round">
					<path d="m2.9277 291.21s1.9513-1.4763 2.9923-2.1296c0.71619-0.44948 2.4456 1.1412 1.8323 1.7128-1.0188 0.94949-2.7281 2.393-3.6841 3.1919-0.42527 0.3554-1.0085-0.0202-1.0085-0.0202-0.34667-0.20565-0.53525-0.38994-0.67523-0.74058" stroke-width=".65774"/>
					<path d="m3.3906 295.24s-0.1942 0.40002-0.5869 1.1576c-0.26611 0.51336-2.1009 0.33429-1.991-0.24053 0.18268-0.9549 0.60053-2.9608 0.80778-3.8003 0.092199-0.37346 0.76722-0.33226 0.76722-0.33226 0.26803 3.7e-4 0.77273 0.25652 0.98514 0.4206" stroke-width=".5"/>
					</g>
				</svg> 
			</a>
		</h1><p><a href=https://github.com/CLIUtils/CLI11 alt=null>CL11</a></p>
<p><a href=https://github.com/p-ranav/argparse alt=null>argparse</a></p>
<p><a href=https://github.com/jarro2783/cxxopts alt=null>cxxopts</a></p>
<p><a href=https://github.com/boostorg/program_options alt=null>boost::program_options</a></p>
<p><a href=https://github.com/muellan/clipp alt=null>clipp</a></p>
<p><a href=https://github.com/hackorama/AnyOption alt=null>AnyOption</a></p>
<p><a href=https://github.com/bfgroup/Lyra alt=null>Lyra</a></p>
<p><a href=https://github.com/lukedeo/option-parser alt=null>Option-parser</a></p>
<p><a href=https://github.com/vietjtnguyen/argagg alt=null>argagg</a></p>
<p>My favorites from this list are <strong>argparse</strong> , mostly because i like original python argparse, <strong>clipp</strong> because its really compact , and <strong>CL11</strong> because it offers alot of features. While features are important, ease of use should be more important for a library of this type.</p>
<h1 id="many-options-but-whats-wrong">Many Options, but whats wrong?!<a href="#many-options-but-whats-wrong">
				<svg width="32" height="32" version="1.1" viewBox="0 0 8.4667 8.4667" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(0 -288.53)" fill="none"  stroke-linecap="round" stroke-linejoin="round">
					<path d="m2.9277 291.21s1.9513-1.4763 2.9923-2.1296c0.71619-0.44948 2.4456 1.1412 1.8323 1.7128-1.0188 0.94949-2.7281 2.393-3.6841 3.1919-0.42527 0.3554-1.0085-0.0202-1.0085-0.0202-0.34667-0.20565-0.53525-0.38994-0.67523-0.74058" stroke-width=".65774"/>
					<path d="m3.3906 295.24s-0.1942 0.40002-0.5869 1.1576c-0.26611 0.51336-2.1009 0.33429-1.991-0.24053 0.18268-0.9549 0.60053-2.9608 0.80778-3.8003 0.092199-0.37346 0.76722-0.33226 0.76722-0.33226 0.26803 3.7e-4 0.77273 0.25652 0.98514 0.4206" stroke-width=".5"/>
					</g>
				</svg> 
			</a>
		</h1><p>Well first off we should set our expectations for what a library that parser arguments should be. 
Most important thing is it should be intuitive and easy to use, we dont want to spend hours just setting up how our arguments are being handled.</p>
<ul>
<li>Single header library ( who wants a behemoth just to handle arguments ðŸ˜“)</li>
<li>Should not contribute to code clutter ( meaning too much boilerplate )</li>
<li>Validate and/or Convert values to a proper type for ease of use</li>
<li>Nested arguement hierarchy ( something akin to <code>git commit</code> <code>git clone</code> )</li>
<li>Raw access to values of the <strong>proper type</strong> ( C++ is still a strictly typed language )</li>
</ul>
<p>So far most libraries give you all, the biggest issue tho is the last point, getting values with their proper type. Having and option named <code>num-threads</code> that should be an integer 
we should expect by fetching it that we get a value thats of type <code>int</code> not a string or something that we have to perform additional conversion.
After doing some research on the listed about libraries and some thinking of what is really possible in the language there are a couple of ways of handling it.</p>
<h2 id="handling-argument-values">Handling argument values</h2><p>Adding an option to our command line argument parser should be combined with selecting a type for it, either for validation or for conversion,otherwise we are just maping names to strings(the arguments).</p>
<ul>
<li><p>Bind to a variable
  Introducing an option we could give it a reference/pointer to an existing variable
this way we get direct access to the value and proper name to refer to. Sounds fine, but if we have to do it for all the options this becomes a mess of forward declared variables,
making our argument parser mostly an empty shell. </p>
</li>
<li><p>Store as a string
  Sad option to be honest, keep the argument as it is maybe validate it based on a specified type, and then when we want to convert it, specify the proper type for that like <code>['--option'].as&lt;Type></code></p>
</li>
<li><p>Type erased
  Type erasure sounds like a great idea, all our options behave the same way, store the value but if we want to retrieve the value we still have to specify the type like with storing it as string</p>
</li>
</ul>
<p>It seems like we have alot of options to handle the values, but all are resulting in making us refer to the type we want multiple times, rather cumbersome in my opinion. That being said the CL11 and Boost::ProgramOptions are great libraries, rather feature heavy if you want to wrap a project fast by adding options.</p>
<p>What is left to do is search for a new way to tackle this issue, our biggest obstacle is ofc the way types are handled in C++, everything that needs a specific type must be known at compile time. Reflection might the the cure but we are still not here, maybe C++23 will rescue us from ugly code.</p>
<h1 id="different-approaches-to-storing-values">Different approaches to storing values<a href="#different-approaches-to-storing-values">
				<svg width="32" height="32" version="1.1" viewBox="0 0 8.4667 8.4667" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(0 -288.53)" fill="none"  stroke-linecap="round" stroke-linejoin="round">
					<path d="m2.9277 291.21s1.9513-1.4763 2.9923-2.1296c0.71619-0.44948 2.4456 1.1412 1.8323 1.7128-1.0188 0.94949-2.7281 2.393-3.6841 3.1919-0.42527 0.3554-1.0085-0.0202-1.0085-0.0202-0.34667-0.20565-0.53525-0.38994-0.67523-0.74058" stroke-width=".65774"/>
					<path d="m3.3906 295.24s-0.1942 0.40002-0.5869 1.1576c-0.26611 0.51336-2.1009 0.33429-1.991-0.24053 0.18268-0.9549 0.60053-2.9608 0.80778-3.8003 0.092199-0.37346 0.76722-0.33226 0.76722-0.33226 0.26803 3.7e-4 0.77273 0.25652 0.98514 0.4206" stroke-width=".5"/>
					</g>
				</svg> 
			</a>
		</h1><p>Here are some of the different strategies we could use to store the options featuring simple examples, not really the best way to implement but a way to illustrate the concept.</p>
<h2 id="store-as-strings">Store as strings</h2><p>Map each option/flag name to the string value it consumed from the passed parameters, simple, all types you use are strings and you can do lexicographical sort on the names for optimization maybe.</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp"><span class="token keyword">struct</span> <span class="token class-name">Option</span><span class="token punctuation">{</span>
    <span class="token keyword">bool</span> required<span class="token punctuation">;</span>
    std<span class="token operator">::</span>string desc<span class="token punctuation">;</span>
    std<span class="token operator">::</span>string help<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

std<span class="token operator">::</span>unsorted_map<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span>Option<span class="token operator">></span> options<span class="token punctuation">;</span>
<span class="token comment">//Iteratable and simple to retrieve</span></code></pre>
<h2 id="store-as-stdvariant">Store as std::variant</h2><p>Same style of mapping but we store the real converted values in a proper variant, still presents us with the problem that we need to specify the type to get it</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp"><span class="token keyword">using</span> OptionTypes <span class="token operator">=</span> std<span class="token operator">::</span>variant<span class="token operator">&lt;</span>Option<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">,</span>Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">,</span>Option<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">>></span><span class="token punctuation">;</span>

std<span class="token operator">::</span>unsorted_map<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span>OptionTypes<span class="token operator">></span> options<span class="token punctuation">;</span>
<span class="token comment">//Iteratable and simple to retrieve</span></code></pre>
<h2 id="store-in-a-tuple">Store in a tuple</h2><p>Tricky but possible to iterate a tuple of elements, retrieving the values is problematic. One aproach leads to the return value being a variant for which we still have to put in the type once more to get the final value. The second approach would be type tagging using a <a href=https://en.cppreference.com/w/cpp/language/user_literal alt=null>user defined literal</a> converting a string to the appropriate index. Another approach i found was using a table mapping the <code>get&lt;Index></code> function pointers but that has the constraints of a single return type ( our table can store only one function pointer type ) more about that <a href=https://www.justsoftwaresolutions.co.uk/cplusplus/getting-tuple-elements-with-runtime-index.html alt=null>here</a>. </p>
<p>An example about this is shown <a href=#my-approach alt=null>here</a>.</p>
<h2 id="store-in-a-struct">Store in a struct</h2><p>Options are defined in a struct, there was a library i saw with an approach like this but it required alot of boilerplate. My concept is having a <a href=https://en.cppreference.com/w/cpp/named_req/PODType alt=null>POD</a> type, converting it to a tuple to iterate it.
Converting the struct to tuple is the tricky part. Retrieving the values becomes trivial because they are just members of a struct. This will be a viable options if there were reflection capabilities in the language.</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp"><span class="token keyword">struct</span> <span class="token class-name">MyOptions</span><span class="token punctuation">{</span>
    Option<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> num <span class="token operator">=</span> Option<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span> x <span class="token operator">=</span> Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span> y <span class="token operator">=</span> Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span> options <span class="token operator">=</span> <span class="token function">MyOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">parse</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span>argv<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre>
<p>Going with this approach, looses our ability to iterate over the items. Here comes <a href=https://en.cppreference.com/w/cpp/language/structured_binding alt=null>structure binding</a> getting us all the items from the structure easily put into a tuple.</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp"><span class="token keyword">struct</span> <span class="token class-name">test</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> index<span class="token punctuation">;</span>
    <span class="token keyword">float</span> freq<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">auto</span> opts <span class="token operator">=</span> test<span class="token punctuation">{</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">3.4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> opts<span class="token punctuation">;</span>
<span class="token keyword">auto</span> tpl <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">make_tuple</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Great solution at first glance but there is no way to handle any number of structure members, unless we hardcode ( generate ) up to a certain length of sizes. This has already been done int the <a href=https://github.com/boostorg/pfr alt=null>PFR library</a> in boost, a great way to interact with POD structures.</p>
<h1 id="my-approach">My approach<a href="#my-approach">
				<svg width="32" height="32" version="1.1" viewBox="0 0 8.4667 8.4667" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(0 -288.53)" fill="none"  stroke-linecap="round" stroke-linejoin="round">
					<path d="m2.9277 291.21s1.9513-1.4763 2.9923-2.1296c0.71619-0.44948 2.4456 1.1412 1.8323 1.7128-1.0188 0.94949-2.7281 2.393-3.6841 3.1919-0.42527 0.3554-1.0085-0.0202-1.0085-0.0202-0.34667-0.20565-0.53525-0.38994-0.67523-0.74058" stroke-width=".65774"/>
					<path d="m3.3906 295.24s-0.1942 0.40002-0.5869 1.1576c-0.26611 0.51336-2.1009 0.33429-1.991-0.24053 0.18268-0.9549 0.60053-2.9608 0.80778-3.8003 0.092199-0.37346 0.76722-0.33226 0.76722-0.33226 0.26803 3.7e-4 0.77273 0.25652 0.98514 0.4206" stroke-width=".5"/>
					</g>
				</svg> 
			</a>
		</h1><p>Lets start with the basic premise, each option has a name, meta information ( like help text,format,default value ) and a type. The type will serve as validator, storage and an extension point.</p>
<p><code>Option&lt;Type>("--name")</code></p>
<p>Now in terms of storing those options, instead of type erasure found that tuples can be used. Most of the work is done by the options anyway so we just need some glue logic.
All the meta information or additional properties can be assigned to the option using chained function calls to make it more compact ( <code>Option&lt;float>().required().desc("")</code> ). So far so good,Parsing now becomes the simple task of going over the separated command line argument strings and iterate over the tuple elements to try and <strong>consume</strong> them (The option class has a member function consume that ).
Now on the topic of reading the parsed value, tuples are accessed by an index at compile time, what we want to do instead is get the value by name(string).</p>
<p>Impossible Time for some fancy constexpr code</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span>size_t I <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">></span>
arg_var <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>get<span class="token operator">&lt;</span>I<span class="token operator">></span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span><span class="token punctuation">.</span>name <span class="token operator">==</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> std<span class="token operator">::</span>get<span class="token operator">&lt;</span>I<span class="token operator">></span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token keyword">constexpr</span> <span class="token punctuation">(</span>I <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">!=</span> std<span class="token operator">::</span>tuple_size_v<span class="token operator">&lt;</span>arg_opt_tupl<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fetch<span class="token operator">&lt;</span>I <span class="token operator">+</span> <span class="token number">1</span><span class="token operator">></span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> std<span class="token operator">::</span>exception<span class="token punctuation">{</span> <span class="token string">"Argument name doesnt exist"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>Its a way to get the value, but required <code>arg_var</code> to be a <code>std::variant&lt;></code> of all the types that can be returned. Still we get a variant at the end, the only thing stopping us mapping a String to a tuple item is the restriction of not having a string as a template argument. That might be possible in the next C++ standard but so far its not. One hack that might be used is converting strings to integers like a hash using user-defined string literals. Would not call that a solution more like bandaid and totally unnecessary.</p>
<p>Having a variant lets us use another feature the visior pattern that can alleviate some pain by lettings us do a comparison/check on values without actually getting them.</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp"> <span class="token keyword">bool</span> testing_cmp <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">"--num"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Testing for a value cannot be easier, only requirement is the comparison operator, but the function has an optional defaulter parameter a comparison function ( internally uses <code>std::equal_to{}</code> ).</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp"><span class="token keyword">bool</span> testing_cmp <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">"--num"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> std<span class="token operator">::</span>greater_equal<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>And finally you might just want to fetch the options themselves ( all of them ) by using the aforementioned structured binding with two simple functions. There is no such thing as nested structured binding 
so we could get the inner options from a command, meaning we hit another limitation of this approach.</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp">Clip p <span class="token operator">=</span> <span class="token function">Clip</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span>
    <span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"commit"</span><span class="token punctuation">,</span>
            Option<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--test"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
            Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--ding"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"push"</span><span class="token punctuation">,</span> 
            Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--test"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
            Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--dong"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    List<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--paths"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Option<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--num"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">"This is great"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">default_value</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--fl"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">"This is great"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">default_value</span><span class="token punctuation">(</span><span class="token number">5.14f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--flz"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">"This is not great"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">default_value</span><span class="token punctuation">(</span><span class="token number">5.14f</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>cmd1<span class="token punctuation">,</span>cmd2<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">fetchAllCommands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>paths<span class="token punctuation">,</span>num<span class="token punctuation">,</span> fl<span class="token punctuation">,</span> flz<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">fetchAllOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>This would be an example declaration of options and their full fetch, the amount of options is checked at compile time. Now one last thing remains is getting the value off and option without getting all of them.</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp"><span class="token keyword">int</span> temp23 <span class="token operator">=</span> p<span class="token punctuation">.</span>fetcher<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--num"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>This is simple wrapper so we dont have to have <code>std::get&lt;></code> in our code and could be wrapped even more so we dont have the <code>.value()</code> call. Looks clean and could have been cleaner if i have found a way to deduce the parameter for <strong>fetcher</strong> making it the perfect clean solution in my opinion.</p>
<p>Having a new look at this, you might think well why is this Wrapped in a class, why dont we all create the options and pass them to the parsing functions, that will do exactly the same. Now we can just access the options as they are, normal variables</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp"><span class="token keyword">auto</span> num <span class="token operator">=</span> Option<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--num"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">"This is great"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">default_value</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span> fl <span class="token operator">=</span> Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--fl"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">"This is great"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">default_value</span><span class="token punctuation">(</span><span class="token number">5.14f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">parse</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span>argv<span class="token punctuation">,</span>
        num<span class="token punctuation">,</span>fl<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// We still have an optional value</span>
</code></pre>
<p>Now this is an interesting concept, out types handle the parsing and validating values and simple functions like <code>parse()</code> and <code>help()</code> glue them together. No inheritance just some <em>simple</em> types and functions that use them. The implementation i did is in no way perfect or even usable in production but more of an <strong>exploration of C++ 17</strong> .</p>
<p>The three implented classes <strong>Option</strong> , <strong>List</strong> , <strong>Command</strong> are the ones doing most of the work. Each one of them contains a name and a <code>consume</code> function that handles consuming values when we encountered their described command line parameter.</p>
<h1 id="option">Option<a href="#option">
				<svg width="32" height="32" version="1.1" viewBox="0 0 8.4667 8.4667" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(0 -288.53)" fill="none"  stroke-linecap="round" stroke-linejoin="round">
					<path d="m2.9277 291.21s1.9513-1.4763 2.9923-2.1296c0.71619-0.44948 2.4456 1.1412 1.8323 1.7128-1.0188 0.94949-2.7281 2.393-3.6841 3.1919-0.42527 0.3554-1.0085-0.0202-1.0085-0.0202-0.34667-0.20565-0.53525-0.38994-0.67523-0.74058" stroke-width=".65774"/>
					<path d="m3.3906 295.24s-0.1942 0.40002-0.5869 1.1576c-0.26611 0.51336-2.1009 0.33429-1.991-0.24053 0.18268-0.9549 0.60053-2.9608 0.80778-3.8003 0.092199-0.37346 0.76722-0.33226 0.76722-0.33226 0.26803 3.7e-4 0.77273 0.25652 0.98514 0.4206" stroke-width=".5"/>
					</g>
				</svg> 
			</a>
		</h1><p>Allows us to parse any type we want with the help of the class(functor) <code>Converter&lt;></code> that has one purpose, to convert a string value that was captured to our type. </p>
<blockquote>
<p>Example: Option&lt;float,1&gt; would capture a single float value at position 1</p>
</blockquote>
<h1 id="list">List<a href="#list">
				<svg width="32" height="32" version="1.1" viewBox="0 0 8.4667 8.4667" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(0 -288.53)" fill="none"  stroke-linecap="round" stroke-linejoin="round">
					<path d="m2.9277 291.21s1.9513-1.4763 2.9923-2.1296c0.71619-0.44948 2.4456 1.1412 1.8323 1.7128-1.0188 0.94949-2.7281 2.393-3.6841 3.1919-0.42527 0.3554-1.0085-0.0202-1.0085-0.0202-0.34667-0.20565-0.53525-0.38994-0.67523-0.74058" stroke-width=".65774"/>
					<path d="m3.3906 295.24s-0.1942 0.40002-0.5869 1.1576c-0.26611 0.51336-2.1009 0.33429-1.991-0.24053 0.18268-0.9549 0.60053-2.9608 0.80778-3.8003 0.092199-0.37346 0.76722-0.33226 0.76722-0.33226 0.26803 3.7e-4 0.77273 0.25652 0.98514 0.4206" stroke-width=".5"/>
					</g>
				</svg> 
			</a>
		</h1><p>Similar to Option but allows us to capture multiple values at once in a vector of values. Using template parameters we can specify the type,position,min and maximum amount of values to capture </p>
<blockquote>
<p>Example: <code>List&lt;int,-1,1,3></code> would capture one,two or three integers at any position</p>
</blockquote>
<h1 id="command">Command<a href="#command">
				<svg width="32" height="32" version="1.1" viewBox="0 0 8.4667 8.4667" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(0 -288.53)" fill="none"  stroke-linecap="round" stroke-linejoin="round">
					<path d="m2.9277 291.21s1.9513-1.4763 2.9923-2.1296c0.71619-0.44948 2.4456 1.1412 1.8323 1.7128-1.0188 0.94949-2.7281 2.393-3.6841 3.1919-0.42527 0.3554-1.0085-0.0202-1.0085-0.0202-0.34667-0.20565-0.53525-0.38994-0.67523-0.74058" stroke-width=".65774"/>
					<path d="m3.3906 295.24s-0.1942 0.40002-0.5869 1.1576c-0.26611 0.51336-2.1009 0.33429-1.991-0.24053 0.18268-0.9549 0.60053-2.9608 0.80778-3.8003 0.092199-0.37346 0.76722-0.33226 0.76722-0.33226 0.26803 3.7e-4 0.77273 0.25652 0.98514 0.4206" stroke-width=".5"/>
					</g>
				</svg> 
			</a>
		</h1><p>Using a command we can handle cases where we had subcommands in command line tools like <code>git</code> , analoguous to &#39;git commit&#39; or <code>git blame</code> where <code>commit</code> and <code>blame</code> is our name of the command. Each command is constructed with a name and any amount of Option and List arguments ( those are specifict to the Command and will only be matched when we are inside the context of that command).</p>
<p>The workhorse of the library are the functions <code>parse</code>  and <code>help</code> , some of their features are rather barebones because i was getting too involved in this library, but there is atleast a foundation laid out if anyone wants to extend or use the library. </p>
<h1 id="final-example-of-usage">Final Example of Usage<a href="#final-example-of-usage">
				<svg width="32" height="32" version="1.1" viewBox="0 0 8.4667 8.4667" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(0 -288.53)" fill="none"  stroke-linecap="round" stroke-linejoin="round">
					<path d="m2.9277 291.21s1.9513-1.4763 2.9923-2.1296c0.71619-0.44948 2.4456 1.1412 1.8323 1.7128-1.0188 0.94949-2.7281 2.393-3.6841 3.1919-0.42527 0.3554-1.0085-0.0202-1.0085-0.0202-0.34667-0.20565-0.53525-0.38994-0.67523-0.74058" stroke-width=".65774"/>
					<path d="m3.3906 295.24s-0.1942 0.40002-0.5869 1.1576c-0.26611 0.51336-2.1009 0.33429-1.991-0.24053 0.18268-0.9549 0.60053-2.9608 0.80778-3.8003 0.092199-0.37346 0.76722-0.33226 0.76722-0.33226 0.26803 3.7e-4 0.77273 0.25652 0.98514 0.4206" stroke-width=".5"/>
					</g>
				</svg> 
			</a>
		</h1><p>Enough talking lets show some example usage, first of the name <code>tuple_of_args</code> because we just have a couple of arguments in a tuple. :)</p>
<pre class="code-segment"><code class="language-cpp" data-language="cpp"><span class="token keyword">using</span> <span class="token keyword">namespace</span> tuple_of_args<span class="token punctuation">;</span>

    <span class="token keyword">auto</span> commit <span class="token operator">=</span> <span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"commit"</span><span class="token punctuation">,</span> 
        Option<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--test"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
        Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--ding"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">auto</span> push <span class="token operator">=</span> <span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">"push"</span><span class="token punctuation">,</span> 
        Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--test"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
        Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--dong"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">auto</span> paths <span class="token operator">=</span> List<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--paths"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">auto</span> num <span class="token operator">=</span> Option<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"num"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">"This is great"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">default_value</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">choice</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">24</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">auto</span> fl <span class="token operator">=</span> Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--fl"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">"This is great"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">default_value</span><span class="token punctuation">(</span><span class="token number">5.14f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">auto</span> flz <span class="token operator">=</span> Option<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"--flz"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">"This is not great"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">default_value</span><span class="token punctuation">(</span><span class="token number">5.14f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token keyword">bool</span> parsed <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> commit<span class="token punctuation">,</span> push<span class="token punctuation">,</span> paths<span class="token punctuation">,</span> num<span class="token punctuation">,</span> fl<span class="token punctuation">,</span> flz<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>parsed<span class="token punctuation">)</span> 
        <span class="token function">help</span><span class="token punctuation">(</span>commit<span class="token punctuation">,</span> push<span class="token punctuation">,</span> paths<span class="token punctuation">,</span> num<span class="token punctuation">,</span> fl<span class="token punctuation">,</span> flz<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>num<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Found the value"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>All of this possible using the power of STL and some type arranging and filtering. The implementation is nowhere near feature complete as any of the ones listed at the start of the article, but it was a fun adventure to go to.</p>
<h1 id="conclusion">Conclusion<a href="#conclusion">
				<svg width="32" height="32" version="1.1" viewBox="0 0 8.4667 8.4667" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(0 -288.53)" fill="none"  stroke-linecap="round" stroke-linejoin="round">
					<path d="m2.9277 291.21s1.9513-1.4763 2.9923-2.1296c0.71619-0.44948 2.4456 1.1412 1.8323 1.7128-1.0188 0.94949-2.7281 2.393-3.6841 3.1919-0.42527 0.3554-1.0085-0.0202-1.0085-0.0202-0.34667-0.20565-0.53525-0.38994-0.67523-0.74058" stroke-width=".65774"/>
					<path d="m3.3906 295.24s-0.1942 0.40002-0.5869 1.1576c-0.26611 0.51336-2.1009 0.33429-1.991-0.24053 0.18268-0.9549 0.60053-2.9608 0.80778-3.8003 0.092199-0.37346 0.76722-0.33226 0.76722-0.33226 0.26803 3.7e-4 0.77273 0.25652 0.98514 0.4206" stroke-width=".5"/>
					</g>
				</svg> 
			</a>
		</h1><p>For a language that has been used and developed for so many years it still feels like there is no proper idiomatic solution that looks and works as one should expect. Maybe its just me being influenced by the ease of use of those sorts of libraries in dynamic languages, who knows. I hope someone finds some parts of it usefull, maybe you will finde some of the neat type filtering and tuple filtering in the foundation helpful, maybe you will find a new and more convenient way to implement it. </p>
<h1 id="repository">Repository<a href="#repository">
				<svg width="32" height="32" version="1.1" viewBox="0 0 8.4667 8.4667" xmlns="http://www.w3.org/2000/svg">
					<g transform="translate(0 -288.53)" fill="none"  stroke-linecap="round" stroke-linejoin="round">
					<path d="m2.9277 291.21s1.9513-1.4763 2.9923-2.1296c0.71619-0.44948 2.4456 1.1412 1.8323 1.7128-1.0188 0.94949-2.7281 2.393-3.6841 3.1919-0.42527 0.3554-1.0085-0.0202-1.0085-0.0202-0.34667-0.20565-0.53525-0.38994-0.67523-0.74058" stroke-width=".65774"/>
					<path d="m3.3906 295.24s-0.1942 0.40002-0.5869 1.1576c-0.26611 0.51336-2.1009 0.33429-1.991-0.24053 0.18268-0.9549 0.60053-2.9608 0.80778-3.8003 0.092199-0.37346 0.76722-0.33226 0.76722-0.33226 0.26803 3.7e-4 0.77273 0.25652 0.98514 0.4206" stroke-width=".5"/>
					</g>
				</svg> 
			</a>
		</h1><p>You can find the final implementation here <a href=https://github.com/Bloodb0ne/tuple_of_args alt=null>https://github.com/Bloodb0ne/tuple_of_args</a>.</p>

    </div>
    <aside class='box'>
        <nav class="toc" offset="80" aria-label="local navigation" >
            <h3>Contents</h3>
            <ul>
                <li class=""><a href="#current-popular-solutions">Current Popular Solutions
				
					
					
					
					
				 
			
		</a></li>
                <li class=""><a href="#many-options-but-whats-wrong">Many Options, but whats wrong?!
				
					
					
					
					
				 
			
		</a></li>
                <li class=""><a href="#different-approaches-to-storing-values">Different approaches to storing values
				
					
					
					
					
				 
			
		</a></li>
                <li class=""><a href="#my-approach">My approach
				
					
					
					
					
				 
			
		</a></li>
                <li class=""><a href="#option">Option
				
					
					
					
					
				 
			
		</a></li>
                <li class=""><a href="#list">List
				
					
					
					
					
				 
			
		</a></li>
                <li class=""><a href="#command">Command
				
					
					
					
					
				 
			
		</a></li>
                <li class=""><a href="#final-example-of-usage">Final Example of Usage
				
					
					
					
					
				 
			
		</a></li>
                <li class=""><a href="#conclusion">Conclusion
				
					
					
					
					
				 
			
		</a></li>
                <li class=""><a href="#repository">Repository
				
					
					
					
					
				 
			
		</a></li>
            </ul>
        </nav>
    </aside>
</main>
</body>
</html>